{% extends 'base.html' %}

{% block content %}
<style>
    .match-container {
        max-width: 500px;
        margin: 50px auto;
        text-align: center;
        font-family: 'Noto Sans KR', sans-serif;
        position: relative; /* ëª¨ë‹¬ ìœ„ì¹˜ ê¸°ì¤€ */
    }

    /* ì¹´ë“œ ìŠ¤íƒ€ì¼ */
    .card-wrapper {
        position: relative;
        height: 500px;
        background: white;
        border-radius: 20px;
        box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        overflow: hidden;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding: 20px;
    }

    .profile-emoji { font-size: 80px; margin-bottom: 20px; background: #f0f2f5; width: 150px; height: 150px; line-height: 150px; border-radius: 50%; }
    .info-badge { background: #e3f2fd; color: #1e88e5; padding: 5px 15px; border-radius: 20px; font-size: 14px; font-weight: bold; margin-bottom: 10px; }
    .user-name { font-size: 24px; font-weight: bold; margin-bottom: 10px; }
    .one-line-intro { color: #666; font-size: 16px; margin-bottom: 30px; padding: 0 20px; line-height: 1.5; word-break: keep-all; }

    /* ë²„íŠ¼ ì˜ì—­ */
    .action-buttons { margin-top: 30px; display: flex; justify-content: center; gap: 30px; }
    .btn-action { width: 70px; height: 70px; border-radius: 50%; border: none; font-size: 30px; cursor: pointer; transition: transform 0.2s; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
    .btn-pass { background: white; color: #ff5252; border: 2px solid #ff5252; }
    .btn-like { background: #4caf50; color: white; }
    .btn-action:hover { transform: scale(1.1); }

    /* ë“±ë¡ ë²„íŠ¼ */
    .btn-register { margin-bottom: 20px; padding: 10px 20px; background-color: #333; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }

    .contact-info { display: none; margin-top: 15px; color: #333; font-weight: bold; background: #fff9c4; padding: 10px; border-radius: 10px; width: 80%; }

    /* ========================== */
    /* â–¼ ëª¨ë‹¬(íŒì—…ì°½) ìŠ¤íƒ€ì¼ ì¶”ê°€ */
    /* ========================== */
    .modal-overlay {
        display: none; /* í‰ì†Œì—” ìˆ¨ê¹€ */
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: rgba(0, 0, 0, 0.5); /* ë°˜íˆ¬ëª… ê²€ì€ ë°°ê²½ */
        z-index: 1000;
        justify-content: center;
        align-items: center;
    }

    .modal-box {
        background: white;
        padding: 30px;
        border-radius: 15px;
        width: 90%;
        max-width: 400px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        text-align: left;
    }

    .modal-box h3 { margin-top: 0; text-align: center; margin-bottom: 20px; }

    .form-group { margin-bottom: 15px; }
    .form-group label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 14px; }
    .form-group input, .form-group select, .form-group textarea {
        width: 100%; padding: 10px;
        border: 1px solid #ddd; border-radius: 5px;
        box-sizing: border-box; /* íŒ¨ë”© í¬í•¨ í¬ê¸° ê³„ì‚° */
    }

    .btn-submit { width: 100%; padding: 12px; background: #3f51b5; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; margin-top: 10px; }
    .btn-close { width: 100%; padding: 10px; background: #eee; color: #333; border: none; border-radius: 5px; cursor: pointer; margin-top: 10px; }

</style>

<div class="match-container">
    <div style="text-align: right;">
        <button class="btn-register" onclick="openModal()">ğŸ“ ë‚´ ì¹´ë“œ ë“±ë¡í•˜ê¸°</button>
    </div>

    <div class="card-wrapper" id="card-area">
        <div class="profile-emoji" id="p-emoji">ğŸ¦</div>
        <span class="info-badge" id="p-field">ë¶„ì•¼</span>
        <h2 class="user-name" id="p-name">ë¡œë”©ì¤‘...</h2>
        <p class="one-line-intro" id="p-intro">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...</p>
        <div class="contact-info" id="p-contact"></div>
    </div>

    <div class="action-buttons">
        <button class="btn-action btn-pass" onclick="nextCard(false)">âœ•</button>
        <button class="btn-action btn-like" onclick="nextCard(true)">â™¥</button>
    </div>
</div>

<div id="registerModal" class="modal-overlay">
    <div class="modal-box">
        <h3>ë‚´ í”„ë¡œí•„ ë“±ë¡ ğŸ“</h3>

        <div class="form-group">
            <label>ì´ëª¨ì§€ (ìŠ¤í„°ë””/ê³µëª¨ì „)</label>
            <select id="input-emoji">
                <option value="ğŸ‘©â€ğŸ’»">ğŸ‘©â€ğŸ’» ìŠ¤í„°ë””</option>
                <option value="ğŸ’¡">ğŸ’¡ ê³µëª¨ì „</option>
            </select>
        </div>

        <div class="form-group">
            <label>ì´ë¦„ (ë‹‰ë„¤ì„)</label>
            <input type="text" id="input-name" placeholder="ì˜ˆ: ê¹€ì½”ë”©">
        </div>

        <div class="form-group">
            <label>ê´€ì‹¬ ë¶„ì•¼</label>
            <input type="text" id="input-field" placeholder="ì˜ˆ: ë°±ì—”ë“œ, ë””ìì¸...">
        </div>

        <div class="form-group">
            <label>í•œì¤„ ì†Œê°œ</label>
            <textarea id="input-intro" rows="2" placeholder="ê°™ì´ ê³µëª¨ì „ ë‚˜ê°€ì‹¤ ë¶„ êµ¬í•´ìš”!"></textarea>
        </div>

        <div class="form-group">
            <label>ì—°ë½ì²˜ (ë§¤ì¹­ë˜ë©´ ë³´ì—¬ìš”)</label>
            <input type="text" id="input-contact" placeholder="ì˜ˆ: ì¹´í†¡ID, ì´ë©”ì¼...">
        </div>

        <button class="btn-submit" onclick="submitCard()">ë“±ë¡ ì™„ë£Œ</button>
        <button class="btn-close" onclick="closeModal()">ì·¨ì†Œ</button>
    </div>
</div>

<script>
    // ì˜ˆì‹œ ë°ì´í„°
    const dummyUsers = [
        { name: "ê¹€í† ìµ", field: "í† ìµ", intro: "í† ìµ ê³µë¶€ ê°™ì´ í•˜ì‹¤ ë¶„ ì°¾ì•„ìš”!.", emoji: "ğŸ‘¨â€ğŸ’»", contact: "ì¹´í†¡ID: yanado_1" },
        { name: "ì´ê³µëª¨", field: "IT", intro: "SW ì›¹/ì•± ê°œë°œ ê³µëª¨ì „ ë‚˜ê°€ì‹¤ ë¶„ ì°¾ìŠµë‹ˆë‹¤.", emoji: "ğŸ’¡", contact: "ì´ë©”ì¼: negajeil@jal.naga" },
        { name: "ë°•ë””ì", field: "UI/UX ë””ìì¸", intro: "í”¼ê·¸ë§ˆ ì˜ ë‹¤ë£¹ë‹ˆë‹¤. í¬íŠ¸í´ë¦¬ì˜¤ ê°™ì´ ë§Œë“œì‹¤ ë¶„!", emoji: "ğŸ‘¨â€ğŸ’»", contact: "ì¸ìŠ¤íƒ€: @design_park" },
    ];

    let currentIndex = 0;

    // 2. ì¹´ë“œ ë Œë”ë§ í•¨ìˆ˜
    function renderCard() {
        const user = dummyUsers[currentIndex];
        const cardArea = document.getElementById('card-area');
        const btnArea = document.querySelector('.action-buttons');

        // ì¹´ë“œê°€ ë”ì´ìƒ ì—†ì„ ë•Œ
        if (!user) {
            cardArea.innerHTML = `
                <div style='text-align:center'>
                    <div style='font-size:50px; margin-bottom:20px;'>ğŸ‰</div>
                    <h3>ëª¨ë“  ì¹´ë“œë¥¼ ë‹¤ ë´¤ì–´ìš”!</h3>
                    <p>ìƒˆë¡œìš´ ì¹œêµ¬ê°€ ë“±ë¡ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.</p>
                    <button onclick='location.reload()' style='margin-top:20px; padding:10px; background:#333; color:white; border:none; border-radius:5px; cursor:pointer;'>ì²˜ìŒë¶€í„° ë‹¤ì‹œ ë³´ê¸°</button>
                </div>
            `;
            btnArea.style.display = 'none';
            return;
        } else {
            if(!document.getElementById('p-name')) {
                location.reload();
                return;
            }
            btnArea.style.display = 'flex';
        }

        document.getElementById('p-emoji').innerText = user.emoji;
        document.getElementById('p-field').innerText = user.field;
        document.getElementById('p-name').innerText = user.name;
        document.getElementById('p-intro').innerText = user.intro;

        const contactDiv = document.getElementById('p-contact');
        contactDiv.innerText = user.contact;
        contactDiv.style.display = 'none';
    }

    // 3. ì¢‹ì•„ìš”/ë„˜ê¸°ê¸° ë¡œì§
    function nextCard(isLike) {
        if (isLike) {
            const contactDiv = document.getElementById('p-contact');
            alert("ğŸ’– ì¢‹ì•„ìš”! ìƒëŒ€ë°©ì˜ ì—°ë½ì²˜ë¥¼ í™•ì¸í•˜ì„¸ìš”:\n\n" + contactDiv.innerText);
            currentIndex++;
            renderCard();
        } else {
            currentIndex++;
            renderCard();
        }
    }

    // 4. ì¹´ë“œ ë“±ë¡ í•¨ìˆ˜
    function openModal() {
        document.getElementById('registerModal').style.display = 'flex';
    }

    function closeModal() {
        document.getElementById('registerModal').style.display = 'none';
        document.getElementById('input-name').value = '';
        document.getElementById('input-field').value = '';
        document.getElementById('input-intro').value = '';
        document.getElementById('input-contact').value = '';
    }

    function submitCard() {
        const emoji = document.getElementById('input-emoji').value;
        const name = document.getElementById('input-name').value;
        const field = document.getElementById('input-field').value;
        const intro = document.getElementById('input-intro').value;
        const contact = document.getElementById('input-contact').value;

        if (!name || !field) {
            alert("ì´ë¦„ê³¼ ë¶„ì•¼ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤!");
            return;
        }

        // ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€ (ë§¨ ë’¤ì— ì¶”ê°€ë¨)
        const newUser = {
            emoji: emoji,
            name: name,
            field: field,
            intro: intro,
            contact: contact
        };

        dummyUsers.push(newUser);

        alert("ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤! ì¹´ë“œ ë¦¬ìŠ¤íŠ¸ ë§ˆì§€ë§‰ì— ì¶”ê°€ë©ë‹ˆë‹¤.");
        closeModal();
    }

    // ì´ˆê¸° ì‹¤í–‰
    renderCard();
</script>
{% endblock %}
